{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import\"../Css/Analytics.css\";import Navbar from\"../components/Navbar\";import Sidebar from\"../components/Sidebar\";import Footer from\"../components/Footer\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";function Analytics(){const[crops,setCrops]=useState([]);/* =========================\r\n     LOAD USER (SESSION) + CROPS\r\n  ========================= */useEffect(()=>{fetch(\"/api/user/get-profile\",{credentials:\"include\"}).then(res=>res.json()).then(user=>{if(!user||user.status===\"error\"){window.location.href=\"/login\";return;}return fetch(\"/api/crop/farmer?farmerId=\".concat(user.farmerId),{credentials:\"include\"});}).then(res=>res===null||res===void 0?void 0:res.json()).then(data=>setCrops(data||[])).catch(()=>console.error(\"Analytics load error\"));},[]);/* =========================\r\n     CALCULATIONS\r\n  ========================= */const totalCrops=crops.length;const avgPrice=totalCrops===0?0:Math.round(crops.reduce((sum,c)=>sum+Number(c.price||0),0)/totalCrops);const totalQty=crops.reduce((sum,c)=>sum+Number(c.quantity||0),0);return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Navbar,{}),/*#__PURE__*/_jsxs(\"div\",{className:\"layout\",children:[/*#__PURE__*/_jsx(Sidebar,{cartCount:0}),/*#__PURE__*/_jsxs(\"div\",{className:\"content-area\",children:[/*#__PURE__*/_jsxs(\"main\",{className:\"analytics-container\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\uD83D\\uDCCA Analytics Overview\"}),/*#__PURE__*/_jsx(\"p\",{className:\"subtitle\",children:\"Track your performance and crop insights\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"analytics-grid\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"a-card\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Total Crops\"}),/*#__PURE__*/_jsx(\"p\",{className:\"big\",children:totalCrops})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"a-card\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Avg Price\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"big\",children:[\"\\u20B9\",avgPrice]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"a-card\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Total Quantity\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"big\",children:[totalQty,\" Kg\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"analytics-chart\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Crop Availability Chart\"}),crops.length===0?/*#__PURE__*/_jsx(\"p\",{children:\"No data available\"}):/*#__PURE__*/_jsx(\"div\",{className:\"bar-chart\",children:crops.map((c,i)=>/*#__PURE__*/_jsxs(\"div\",{className:\"bar-item\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bar\",style:{height:\"\".concat(Math.max(Number(c.quantity||0)*2,10),\"px\")}}),/*#__PURE__*/_jsx(\"span\",{children:c.cropName})]},c.cropId||i))})]})]}),/*#__PURE__*/_jsx(Footer,{})]})]})]});}export default Analytics;","map":{"version":3,"names":["React","useEffect","useState","Navbar","Sidebar","Footer","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Analytics","crops","setCrops","fetch","credentials","then","res","json","user","status","window","location","href","concat","farmerId","data","catch","console","error","totalCrops","length","avgPrice","Math","round","reduce","sum","c","Number","price","totalQty","quantity","children","className","cartCount","map","i","style","height","max","cropName","cropId"],"sources":["D:/AgroLink/frontend/src/components/Analytics.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport \"../Css/Analytics.css\";\r\nimport Navbar from \"../components/Navbar\";\r\nimport Sidebar from \"../components/Sidebar\";\r\nimport Footer from \"../components/Footer\";\r\n\r\nfunction Analytics() {\r\n  const [crops, setCrops] = useState([]);\r\n\r\n  /* =========================\r\n     LOAD USER (SESSION) + CROPS\r\n  ========================= */\r\n  useEffect(() => {\r\n    fetch(\"/api/user/get-profile\", {\r\n      credentials: \"include\",\r\n    })\r\n      .then((res) => res.json())\r\n      .then((user) => {\r\n        if (!user || user.status === \"error\") {\r\n          window.location.href = \"/login\";\r\n          return;\r\n        }\r\n\r\n        return fetch(\r\n          `/api/crop/farmer?farmerId=${user.farmerId}`,\r\n          { credentials: \"include\" }\r\n        );\r\n      })\r\n      .then((res) => res?.json())\r\n      .then((data) => setCrops(data || []))\r\n      .catch(() => console.error(\"Analytics load error\"));\r\n  }, []);\r\n\r\n  /* =========================\r\n     CALCULATIONS\r\n  ========================= */\r\n  const totalCrops = crops.length;\r\n\r\n  const avgPrice =\r\n    totalCrops === 0\r\n      ? 0\r\n      : Math.round(\r\n          crops.reduce((sum, c) => sum + Number(c.price || 0), 0) / totalCrops\r\n        );\r\n\r\n  const totalQty = crops.reduce(\r\n    (sum, c) => sum + Number(c.quantity || 0),\r\n    0\r\n  );\r\n\r\n  return (\r\n    <>\r\n      <Navbar />\r\n\r\n      <div className=\"layout\">\r\n        <Sidebar cartCount={0} />\r\n\r\n        <div className=\"content-area\">\r\n          <main className=\"analytics-container\">\r\n            <h2>ðŸ“Š Analytics Overview</h2>\r\n            <p className=\"subtitle\">\r\n              Track your performance and crop insights\r\n            </p>\r\n\r\n            <div className=\"analytics-grid\">\r\n              <div className=\"a-card\">\r\n                <h3>Total Crops</h3>\r\n                <p className=\"big\">{totalCrops}</p>\r\n              </div>\r\n\r\n              <div className=\"a-card\">\r\n                <h3>Avg Price</h3>\r\n                <p className=\"big\">â‚¹{avgPrice}</p>\r\n              </div>\r\n\r\n              <div className=\"a-card\">\r\n                <h3>Total Quantity</h3>\r\n                <p className=\"big\">{totalQty} Kg</p>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"analytics-chart\">\r\n              <h3>Crop Availability Chart</h3>\r\n\r\n              {crops.length === 0 ? (\r\n                <p>No data available</p>\r\n              ) : (\r\n                <div className=\"bar-chart\">\r\n                  {crops.map((c, i) => (\r\n                    <div key={c.cropId || i} className=\"bar-item\">\r\n                      <div\r\n                        className=\"bar\"\r\n                        style={{\r\n                          height: `${Math.max(\r\n                            Number(c.quantity || 0) * 2,\r\n                            10\r\n                          )}px`,\r\n                        }}\r\n                      ></div>\r\n                      <span>{c.cropName}</span>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              )}\r\n            </div>\r\n          </main>\r\n\r\n          <Footer />\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default Analytics;\r\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAClD,MAAO,sBAAsB,CAC7B,MAAO,CAAAC,MAAM,KAAM,sBAAsB,CACzC,MAAO,CAAAC,OAAO,KAAM,uBAAuB,CAC3C,MAAO,CAAAC,MAAM,KAAM,sBAAsB,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,CAAAC,QAAA,IAAAC,SAAA,yBAE1C,QAAS,CAAAC,SAASA,CAAA,CAAG,CACnB,KAAM,CAACC,KAAK,CAAEC,QAAQ,CAAC,CAAGZ,QAAQ,CAAC,EAAE,CAAC,CAEtC;AACF;AACA,8BACED,SAAS,CAAC,IAAM,CACdc,KAAK,CAAC,uBAAuB,CAAE,CAC7BC,WAAW,CAAE,SACf,CAAC,CAAC,CACCC,IAAI,CAAEC,GAAG,EAAKA,GAAG,CAACC,IAAI,CAAC,CAAC,CAAC,CACzBF,IAAI,CAAEG,IAAI,EAAK,CACd,GAAI,CAACA,IAAI,EAAIA,IAAI,CAACC,MAAM,GAAK,OAAO,CAAE,CACpCC,MAAM,CAACC,QAAQ,CAACC,IAAI,CAAG,QAAQ,CAC/B,OACF,CAEA,MAAO,CAAAT,KAAK,8BAAAU,MAAA,CACmBL,IAAI,CAACM,QAAQ,EAC1C,CAAEV,WAAW,CAAE,SAAU,CAC3B,CAAC,CACH,CAAC,CAAC,CACDC,IAAI,CAAEC,GAAG,EAAKA,GAAG,SAAHA,GAAG,iBAAHA,GAAG,CAAEC,IAAI,CAAC,CAAC,CAAC,CAC1BF,IAAI,CAAEU,IAAI,EAAKb,QAAQ,CAACa,IAAI,EAAI,EAAE,CAAC,CAAC,CACpCC,KAAK,CAAC,IAAMC,OAAO,CAACC,KAAK,CAAC,sBAAsB,CAAC,CAAC,CACvD,CAAC,CAAE,EAAE,CAAC,CAEN;AACF;AACA,8BACE,KAAM,CAAAC,UAAU,CAAGlB,KAAK,CAACmB,MAAM,CAE/B,KAAM,CAAAC,QAAQ,CACZF,UAAU,GAAK,CAAC,CACZ,CAAC,CACDG,IAAI,CAACC,KAAK,CACRtB,KAAK,CAACuB,MAAM,CAAC,CAACC,GAAG,CAAEC,CAAC,GAAKD,GAAG,CAAGE,MAAM,CAACD,CAAC,CAACE,KAAK,EAAI,CAAC,CAAC,CAAE,CAAC,CAAC,CAAGT,UAC5D,CAAC,CAEP,KAAM,CAAAU,QAAQ,CAAG5B,KAAK,CAACuB,MAAM,CAC3B,CAACC,GAAG,CAAEC,CAAC,GAAKD,GAAG,CAAGE,MAAM,CAACD,CAAC,CAACI,QAAQ,EAAI,CAAC,CAAC,CACzC,CACF,CAAC,CAED,mBACEjC,KAAA,CAAAE,SAAA,EAAAgC,QAAA,eACEpC,IAAA,CAACJ,MAAM,GAAE,CAAC,cAEVM,KAAA,QAAKmC,SAAS,CAAC,QAAQ,CAAAD,QAAA,eACrBpC,IAAA,CAACH,OAAO,EAACyC,SAAS,CAAE,CAAE,CAAE,CAAC,cAEzBpC,KAAA,QAAKmC,SAAS,CAAC,cAAc,CAAAD,QAAA,eAC3BlC,KAAA,SAAMmC,SAAS,CAAC,qBAAqB,CAAAD,QAAA,eACnCpC,IAAA,OAAAoC,QAAA,CAAI,iCAAqB,CAAI,CAAC,cAC9BpC,IAAA,MAAGqC,SAAS,CAAC,UAAU,CAAAD,QAAA,CAAC,0CAExB,CAAG,CAAC,cAEJlC,KAAA,QAAKmC,SAAS,CAAC,gBAAgB,CAAAD,QAAA,eAC7BlC,KAAA,QAAKmC,SAAS,CAAC,QAAQ,CAAAD,QAAA,eACrBpC,IAAA,OAAAoC,QAAA,CAAI,aAAW,CAAI,CAAC,cACpBpC,IAAA,MAAGqC,SAAS,CAAC,KAAK,CAAAD,QAAA,CAAEZ,UAAU,CAAI,CAAC,EAChC,CAAC,cAENtB,KAAA,QAAKmC,SAAS,CAAC,QAAQ,CAAAD,QAAA,eACrBpC,IAAA,OAAAoC,QAAA,CAAI,WAAS,CAAI,CAAC,cAClBlC,KAAA,MAAGmC,SAAS,CAAC,KAAK,CAAAD,QAAA,EAAC,QAAC,CAACV,QAAQ,EAAI,CAAC,EAC/B,CAAC,cAENxB,KAAA,QAAKmC,SAAS,CAAC,QAAQ,CAAAD,QAAA,eACrBpC,IAAA,OAAAoC,QAAA,CAAI,gBAAc,CAAI,CAAC,cACvBlC,KAAA,MAAGmC,SAAS,CAAC,KAAK,CAAAD,QAAA,EAAEF,QAAQ,CAAC,KAAG,EAAG,CAAC,EACjC,CAAC,EACH,CAAC,cAENhC,KAAA,QAAKmC,SAAS,CAAC,iBAAiB,CAAAD,QAAA,eAC9BpC,IAAA,OAAAoC,QAAA,CAAI,yBAAuB,CAAI,CAAC,CAE/B9B,KAAK,CAACmB,MAAM,GAAK,CAAC,cACjBzB,IAAA,MAAAoC,QAAA,CAAG,mBAAiB,CAAG,CAAC,cAExBpC,IAAA,QAAKqC,SAAS,CAAC,WAAW,CAAAD,QAAA,CACvB9B,KAAK,CAACiC,GAAG,CAAC,CAACR,CAAC,CAAES,CAAC,gBACdtC,KAAA,QAAyBmC,SAAS,CAAC,UAAU,CAAAD,QAAA,eAC3CpC,IAAA,QACEqC,SAAS,CAAC,KAAK,CACfI,KAAK,CAAE,CACLC,MAAM,IAAAxB,MAAA,CAAKS,IAAI,CAACgB,GAAG,CACjBX,MAAM,CAACD,CAAC,CAACI,QAAQ,EAAI,CAAC,CAAC,CAAG,CAAC,CAC3B,EACF,CAAC,MACH,CAAE,CACE,CAAC,cACPnC,IAAA,SAAAoC,QAAA,CAAOL,CAAC,CAACa,QAAQ,CAAO,CAAC,GAVjBb,CAAC,CAACc,MAAM,EAAIL,CAWjB,CACN,CAAC,CACC,CACN,EACE,CAAC,EACF,CAAC,cAEPxC,IAAA,CAACF,MAAM,GAAE,CAAC,EACP,CAAC,EACH,CAAC,EACN,CAAC,CAEP,CAEA,cAAe,CAAAO,SAAS","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
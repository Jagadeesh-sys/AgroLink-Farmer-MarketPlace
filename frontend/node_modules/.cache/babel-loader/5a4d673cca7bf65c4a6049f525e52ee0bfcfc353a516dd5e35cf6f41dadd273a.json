{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import{BrowserRouter as Router,Routes,Route,Navigate}from\"react-router-dom\";/* ===== COMMON ===== */import Home from\"./components/Home\";import Signup from\"./pages/Signup\";import Login from\"./pages/Login\";import Profile from\"./pages/Profile\";/* ===== MARKETPLACE ===== */import Marketplace from\"./pages/Marketplace\";import Sell from\"./pages/Sell\";import Buy from\"./pages/Buy\";import Seeds from\"./pages/Seeds\";import Pesticides from\"./pages/Pesticides\";import Fertilizers from\"./pages/Fertilizers\";/* ===== USER DASHBOARD ===== */import Dashboard from\"./pages/Dashboard\";import Analytics from\"./components/Analytics\";import MyCrops from\"./components/MyCrops\";import Settings from\"./components/Settings\";import Support from\"./components/Support\";/* ===== CART & ORDERS ===== */import Cart from\"./components/Cart\";import Checkout from\"./components/Checkout\";import TrackOrder from\"./pages/TrackOrder\";import MyOrders from\"./pages/MyOrders\";/* ===== OTHER ===== */import Contact from\"./pages/Contact\";import LoanPage from\"./pages/LoanPage\";import InsurancePage from\"./pages/InsurancePage\";/* ===== ADMIN ===== */import AdminDashboard from\"./components/AdminDashboard\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function App(){const[systemRole,setSystemRole]=useState(null);const[checked,setChecked]=useState(false);/* ==============================\n     CHECK SESSION ROLE (ONCE)\n  ============================== */useEffect(()=>{const checkAuth=async()=>{try{const res=await fetch(\"/api/user/get-profile\",{credentials:\"include\",cache:\"no-store\"});if(res.ok){const data=await res.json();if((data===null||data===void 0?void 0:data.status)!==\"error\"){setSystemRole(data.systemRole||null);}else{setSystemRole(null);}}else{setSystemRole(null);}}catch(_unused){setSystemRole(null);}finally{setChecked(true);// âœ… AUTH CHECK COMPLETE\n}};checkAuth();},[]);/* ðŸ”¥ IMPORTANT: WAIT FOR AUTH CHECK */if(!checked){return/*#__PURE__*/_jsx(\"div\",{style:{textAlign:\"center\",marginTop:\"100px\"},children:\"Loading...\"});}return/*#__PURE__*/_jsx(Router,{children:/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{path:\"/\",element:/*#__PURE__*/_jsx(Home,{})}),/*#__PURE__*/_jsx(Route,{path:\"/home\",element:/*#__PURE__*/_jsx(Home,{})}),/*#__PURE__*/_jsx(Route,{path:\"/signup\",element:/*#__PURE__*/_jsx(Signup,{})}),/*#__PURE__*/_jsx(Route,{path:\"/login\",element:/*#__PURE__*/_jsx(Login,{})}),/*#__PURE__*/_jsx(Route,{path:\"/profile\",element:/*#__PURE__*/_jsx(Profile,{})}),/*#__PURE__*/_jsx(Route,{path:\"/dashboard\",element:/*#__PURE__*/_jsx(Dashboard,{})}),/*#__PURE__*/_jsx(Route,{path:\"/dashboard/mycrops\",element:/*#__PURE__*/_jsx(MyCrops,{})}),/*#__PURE__*/_jsx(Route,{path:\"/analytics\",element:/*#__PURE__*/_jsx(Analytics,{})}),/*#__PURE__*/_jsx(Route,{path:\"/settings\",element:/*#__PURE__*/_jsx(Settings,{})}),/*#__PURE__*/_jsx(Route,{path:\"/support\",element:/*#__PURE__*/_jsx(Support,{})}),/*#__PURE__*/_jsx(Route,{path:\"/cart\",element:/*#__PURE__*/_jsx(Cart,{})}),/*#__PURE__*/_jsx(Route,{path:\"/checkout\",element:/*#__PURE__*/_jsx(Checkout,{})}),/*#__PURE__*/_jsx(Route,{path:\"/orders/:orderId\",element:/*#__PURE__*/_jsx(TrackOrder,{})}),/*#__PURE__*/_jsx(Route,{path:\"/my-orders\",element:/*#__PURE__*/_jsx(MyOrders,{})}),/*#__PURE__*/_jsxs(Route,{path:\"/marketplace\",element:/*#__PURE__*/_jsx(Marketplace,{}),children:[/*#__PURE__*/_jsx(Route,{index:true,element:/*#__PURE__*/_jsx(Seeds,{})}),/*#__PURE__*/_jsx(Route,{path:\"sell\",element:/*#__PURE__*/_jsx(Sell,{})}),/*#__PURE__*/_jsx(Route,{path:\"buy\",element:/*#__PURE__*/_jsx(Buy,{})}),/*#__PURE__*/_jsx(Route,{path:\"seeds\",element:/*#__PURE__*/_jsx(Seeds,{})}),/*#__PURE__*/_jsx(Route,{path:\"pesticides\",element:/*#__PURE__*/_jsx(Pesticides,{})}),/*#__PURE__*/_jsx(Route,{path:\"fertilizers\",element:/*#__PURE__*/_jsx(Fertilizers,{})})]}),/*#__PURE__*/_jsx(Route,{path:\"/loans\",element:/*#__PURE__*/_jsx(LoanPage,{})}),/*#__PURE__*/_jsx(Route,{path:\"/insurance\",element:/*#__PURE__*/_jsx(InsurancePage,{})}),/*#__PURE__*/_jsx(Route,{path:\"/contact\",element:/*#__PURE__*/_jsx(Contact,{})}),/*#__PURE__*/_jsx(Route,{path:\"/admin\",element:systemRole===\"ADMIN\"?/*#__PURE__*/_jsx(AdminDashboard,{}):/*#__PURE__*/_jsx(Navigate,{to:\"/home\",replace:true})})]})});}export default App;","map":{"version":3,"names":["React","useEffect","useState","BrowserRouter","Router","Routes","Route","Navigate","Home","Signup","Login","Profile","Marketplace","Sell","Buy","Seeds","Pesticides","Fertilizers","Dashboard","Analytics","MyCrops","Settings","Support","Cart","Checkout","TrackOrder","MyOrders","Contact","LoanPage","InsurancePage","AdminDashboard","jsx","_jsx","jsxs","_jsxs","App","systemRole","setSystemRole","checked","setChecked","checkAuth","res","fetch","credentials","cache","ok","data","json","status","_unused","style","textAlign","marginTop","children","path","element","index","to","replace"],"sources":["D:/AgroLink/frontend/src/App.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { BrowserRouter as Router, Routes, Route, Navigate } from \"react-router-dom\";\n\n/* ===== COMMON ===== */\nimport Home from \"./components/Home\";\nimport Signup from \"./pages/Signup\";\nimport Login from \"./pages/Login\";\nimport Profile from \"./pages/Profile\";\n\n/* ===== MARKETPLACE ===== */\nimport Marketplace from \"./pages/Marketplace\";\nimport Sell from \"./pages/Sell\";\nimport Buy from \"./pages/Buy\";\nimport Seeds from \"./pages/Seeds\";\nimport Pesticides from \"./pages/Pesticides\";\nimport Fertilizers from \"./pages/Fertilizers\";\n\n/* ===== USER DASHBOARD ===== */\nimport Dashboard from \"./pages/Dashboard\";\nimport Analytics from \"./components/Analytics\";\nimport MyCrops from \"./components/MyCrops\";\nimport Settings from \"./components/Settings\";\nimport Support from \"./components/Support\";\n\n/* ===== CART & ORDERS ===== */\nimport Cart from \"./components/Cart\";\nimport Checkout from \"./components/Checkout\";\nimport TrackOrder from \"./pages/TrackOrder\";\nimport MyOrders from \"./pages/MyOrders\";\n\n/* ===== OTHER ===== */\nimport Contact from \"./pages/Contact\";\nimport LoanPage from \"./pages/LoanPage\";\nimport InsurancePage from \"./pages/InsurancePage\";\n\n/* ===== ADMIN ===== */\nimport AdminDashboard from \"./components/AdminDashboard\";\n\nfunction App() {\n  const [systemRole, setSystemRole] = useState(null);\n  const [checked, setChecked] = useState(false);\n\n  /* ==============================\n     CHECK SESSION ROLE (ONCE)\n  ============================== */\n  useEffect(() => {\n    const checkAuth = async () => {\n      try {\n        const res = await fetch(\"/api/user/get-profile\", {\n          credentials: \"include\",\n          cache: \"no-store\",\n        });\n\n        if (res.ok) {\n          const data = await res.json();\n          if (data?.status !== \"error\") {\n            setSystemRole(data.systemRole || null);\n          } else {\n            setSystemRole(null);\n          }\n        } else {\n          setSystemRole(null);\n        }\n      } catch {\n        setSystemRole(null);\n      } finally {\n        setChecked(true); // âœ… AUTH CHECK COMPLETE\n      }\n    };\n\n    checkAuth();\n  }, []);\n\n  /* ðŸ”¥ IMPORTANT: WAIT FOR AUTH CHECK */\n  if (!checked) {\n    return (\n      <div style={{ textAlign: \"center\", marginTop: \"100px\" }}>\n        Loading...\n      </div>\n    );\n  }\n\n  return (\n    <Router>\n      <Routes>\n\n        {/* ===== HOME ===== */}\n        <Route path=\"/\" element={<Home />} />\n        <Route path=\"/home\" element={<Home />} />\n\n        {/* ===== AUTH ===== */}\n        <Route path=\"/signup\" element={<Signup />} />\n        <Route path=\"/login\" element={<Login />} />\n        <Route path=\"/profile\" element={<Profile />} />\n\n        {/* ===== USER DASHBOARD ===== */}\n        <Route path=\"/dashboard\" element={<Dashboard />} />\n        <Route path=\"/dashboard/mycrops\" element={<MyCrops />} />\n        <Route path=\"/analytics\" element={<Analytics />} />\n        <Route path=\"/settings\" element={<Settings />} />\n        <Route path=\"/support\" element={<Support />} />\n\n        {/* ===== CART & ORDERS ===== */}\n        <Route path=\"/cart\" element={<Cart />} />\n        <Route path=\"/checkout\" element={<Checkout />} />\n        <Route path=\"/orders/:orderId\" element={<TrackOrder />} />\n        <Route path=\"/my-orders\" element={<MyOrders />} />\n\n        {/* ===== MARKETPLACE ===== */}\n        <Route path=\"/marketplace\" element={<Marketplace />}>\n          <Route index element={<Seeds />} />\n          <Route path=\"sell\" element={<Sell />} />\n          <Route path=\"buy\" element={<Buy />} />\n          <Route path=\"seeds\" element={<Seeds />} />\n          <Route path=\"pesticides\" element={<Pesticides />} />\n          <Route path=\"fertilizers\" element={<Fertilizers />} />\n        </Route>\n\n        {/* ===== SERVICES ===== */}\n        <Route path=\"/loans\" element={<LoanPage />} />\n        <Route path=\"/insurance\" element={<InsurancePage />} />\n        <Route path=\"/contact\" element={<Contact />} />\n\n        {/* ===== ADMIN (PROTECTED) ===== */}\n        <Route\n          path=\"/admin\"\n          element={\n            systemRole === \"ADMIN\" ? (\n              <AdminDashboard />\n            ) : (\n              <Navigate to=\"/home\" replace />\n            )\n          }\n        />\n\n      </Routes>\n    </Router>\n  );\n}\n\nexport default App;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
{"ast":null,"code":"import _objectSpread from\"D:/AgroLink/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState}from\"react\";import{useNavigate}from\"react-router-dom\";import Navbar from\"../components/Navbar\";import Sidebar from\"../components/Sidebar\";import Footer from\"../components/Footer\";import\"../Css/MyOrders.css\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";function MyOrders(){const navigate=useNavigate();const[orders,setOrders]=useState(JSON.parse(localStorage.getItem(\"orders\"))||[]);/* =========================\r\n     IMAGE HANDLER – FINAL FIX ✅\r\n     ✔ external URLs (seeds)\r\n     ✔ local uploads (crops)\r\n  ========================= */const getImage=imgStr=>{// ❌ no image\nif(!imgStr||imgStr.trim()===\"\"){return process.env.PUBLIC_URL+\"/Images/noimg.png\";}// ✅ SEEDS / EXTERNAL IMAGE (Amazon, CDN, etc.)\nif(imgStr.startsWith(\"http\")){return imgStr;}// ✅ FARMER CROPS (LOCAL UPLOADS)\nconst list=imgStr.split(\",\").map(i=>i.trim()).filter(Boolean);if(!list.length){return process.env.PUBLIC_URL+\"/Images/noimg.png\";}// DB stores: uploads/filename.jpg\nconst fileName=list[0].replace(\"uploads/\",\"\");return\"http://localhost:9090/backend/uploads/\".concat(fileName);};/* =========================\r\n     CANCEL ORDER\r\n  ========================= */const cancelOrder=orderId=>{const confirmCancel=window.confirm(\"Are you sure you want to cancel this order?\");if(!confirmCancel)return;const updatedOrders=orders.map(order=>order.orderId===orderId?_objectSpread(_objectSpread({},order),{},{status:\"Cancelled\"}):order);setOrders(updatedOrders);localStorage.setItem(\"orders\",JSON.stringify(updatedOrders));};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Navbar,{}),/*#__PURE__*/_jsxs(\"div\",{className:\"layout\",children:[/*#__PURE__*/_jsx(Sidebar,{cartCount:0}),/*#__PURE__*/_jsxs(\"div\",{className:\"orders-content\",children:[/*#__PURE__*/_jsxs(\"main\",{className:\"orders-main\",children:[/*#__PURE__*/_jsxs(\"header\",{className:\"orders-header\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"My Orders\"}),/*#__PURE__*/_jsx(\"p\",{children:\"View, track or cancel your orders\"})]}),orders.length===0?/*#__PURE__*/_jsx(\"div\",{className:\"orders-empty\",children:\"You have not placed any orders yet.\"}):/*#__PURE__*/_jsx(\"div\",{className:\"orders-list\",children:orders.map(order=>{var _order$payment;return/*#__PURE__*/_jsxs(\"div\",{className:\"order-card\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"order-top\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"b\",{children:\"Order ID:\"}),\" \",order.orderId]}),/*#__PURE__*/_jsx(\"span\",{className:\"order-status \".concat(order.status===\"Cancelled\"?\"status-cancelled\":\"\"),children:order.status})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"order-meta\",children:[/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(\"b\",{children:\"Date:\"}),\" \",new Date(order.date).toLocaleString()]}),/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(\"b\",{children:\"Payment:\"}),\" \",((_order$payment=order.payment)===null||_order$payment===void 0?void 0:_order$payment.toUpperCase())||\"COD\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"order-items\",children:[order.items.slice(0,3).map(item=>/*#__PURE__*/_jsxs(\"div\",{className:\"order-item-row\",children:[/*#__PURE__*/_jsx(\"img\",{src:getImage(item.images),alt:item.cropName,className:\"order-item-img\",onError:e=>{e.target.onerror=null;e.target.src=process.env.PUBLIC_URL+\"/Images/noimg.png\";}}),/*#__PURE__*/_jsxs(\"div\",{className:\"order-item-info\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"order-item-name\",children:item.cropName}),/*#__PURE__*/_jsxs(\"div\",{className:\"order-item-meta\",children:[item.qty,\" \\xD7 \\u20B9\",item.price]})]})]},item.cropId)),order.items.length>3&&/*#__PURE__*/_jsxs(\"div\",{className:\"more-items\",children:[\"+\",order.items.length-3,\" more items\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"order-footer\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"order-total\",children:[\"\\u20B9\",order.total]}),/*#__PURE__*/_jsxs(\"div\",{className:\"order-actions\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"track-btn\",onClick:()=>navigate(\"/orders/\".concat(order.orderId)),children:\"Track Order\"}),order.status!==\"Cancelled\"&&/*#__PURE__*/_jsx(\"button\",{className:\"cancel-btn\",onClick:()=>cancelOrder(order.orderId),children:\"Cancel\"})]})]})]},order.orderId);})})]}),/*#__PURE__*/_jsx(Footer,{})]})]})]});}export default MyOrders;","map":{"version":3,"names":["React","useState","useNavigate","Navbar","Sidebar","Footer","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","MyOrders","navigate","orders","setOrders","JSON","parse","localStorage","getItem","getImage","imgStr","trim","process","env","PUBLIC_URL","startsWith","list","split","map","i","filter","Boolean","length","fileName","replace","concat","cancelOrder","orderId","confirmCancel","window","confirm","updatedOrders","order","_objectSpread","status","setItem","stringify","children","className","cartCount","_order$payment","Date","date","toLocaleString","payment","toUpperCase","items","slice","item","src","images","alt","cropName","onError","e","target","onerror","qty","price","cropId","total","onClick"],"sources":["D:/AgroLink/frontend/src/pages/MyOrders.js"],"sourcesContent":["import React, { useState } from \"react\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport Navbar from \"../components/Navbar\";\r\nimport Sidebar from \"../components/Sidebar\";\r\nimport Footer from \"../components/Footer\";\r\nimport \"../Css/MyOrders.css\";\r\n\r\nfunction MyOrders() {\r\n  const navigate = useNavigate();\r\n\r\n  const [orders, setOrders] = useState(\r\n    JSON.parse(localStorage.getItem(\"orders\")) || []\r\n  );\r\n\r\n  /* =========================\r\n     IMAGE HANDLER – FINAL FIX ✅\r\n     ✔ external URLs (seeds)\r\n     ✔ local uploads (crops)\r\n  ========================= */\r\n  const getImage = (imgStr) => {\r\n    // ❌ no image\r\n    if (!imgStr || imgStr.trim() === \"\") {\r\n      return process.env.PUBLIC_URL + \"/Images/noimg.png\";\r\n    }\r\n\r\n    // ✅ SEEDS / EXTERNAL IMAGE (Amazon, CDN, etc.)\r\n    if (imgStr.startsWith(\"http\")) {\r\n      return imgStr;\r\n    }\r\n\r\n    // ✅ FARMER CROPS (LOCAL UPLOADS)\r\n    const list = imgStr\r\n      .split(\",\")\r\n      .map((i) => i.trim())\r\n      .filter(Boolean);\r\n\r\n    if (!list.length) {\r\n      return process.env.PUBLIC_URL + \"/Images/noimg.png\";\r\n    }\r\n\r\n    // DB stores: uploads/filename.jpg\r\n    const fileName = list[0].replace(\"uploads/\", \"\");\r\n\r\n    return `http://localhost:9090/backend/uploads/${fileName}`;\r\n  };\r\n\r\n  /* =========================\r\n     CANCEL ORDER\r\n  ========================= */\r\n  const cancelOrder = (orderId) => {\r\n    const confirmCancel = window.confirm(\r\n      \"Are you sure you want to cancel this order?\"\r\n    );\r\n    if (!confirmCancel) return;\r\n\r\n    const updatedOrders = orders.map((order) =>\r\n      order.orderId === orderId\r\n        ? { ...order, status: \"Cancelled\" }\r\n        : order\r\n    );\r\n\r\n    setOrders(updatedOrders);\r\n    localStorage.setItem(\"orders\", JSON.stringify(updatedOrders));\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <Navbar />\r\n\r\n      <div className=\"layout\">\r\n        <Sidebar cartCount={0} />\r\n\r\n        <div className=\"orders-content\">\r\n          <main className=\"orders-main\">\r\n            <header className=\"orders-header\">\r\n              <h2>My Orders</h2>\r\n              <p>View, track or cancel your orders</p>\r\n            </header>\r\n\r\n            {orders.length === 0 ? (\r\n              <div className=\"orders-empty\">\r\n                You have not placed any orders yet.\r\n              </div>\r\n            ) : (\r\n              <div className=\"orders-list\">\r\n                {orders.map((order) => (\r\n                  <div className=\"order-card\" key={order.orderId}>\r\n                    {/* TOP */}\r\n                    <div className=\"order-top\">\r\n                      <div>\r\n                        <b>Order ID:</b> {order.orderId}\r\n                      </div>\r\n\r\n                      <span\r\n                        className={`order-status ${\r\n                          order.status === \"Cancelled\"\r\n                            ? \"status-cancelled\"\r\n                            : \"\"\r\n                        }`}\r\n                      >\r\n                        {order.status}\r\n                      </span>\r\n                    </div>\r\n\r\n                    {/* META */}\r\n                    <div className=\"order-meta\">\r\n                      <span>\r\n                        <b>Date:</b>{\" \"}\r\n                        {new Date(order.date).toLocaleString()}\r\n                      </span>\r\n                      <span>\r\n                        <b>Payment:</b>{\" \"}\r\n                        {order.payment?.toUpperCase() || \"COD\"}\r\n                      </span>\r\n                    </div>\r\n\r\n                    {/* ITEMS */}\r\n                    <div className=\"order-items\">\r\n                      {order.items.slice(0, 3).map((item) => (\r\n                        <div\r\n                          className=\"order-item-row\"\r\n                          key={item.cropId}\r\n                        >\r\n                          <img\r\n                            src={getImage(item.images)}\r\n                            alt={item.cropName}\r\n                            className=\"order-item-img\"\r\n                            onError={(e) => {\r\n                              e.target.onerror = null;\r\n                              e.target.src =\r\n                                process.env.PUBLIC_URL +\r\n                                \"/Images/noimg.png\";\r\n                            }}\r\n                          />\r\n\r\n                          <div className=\"order-item-info\">\r\n                            <div className=\"order-item-name\">\r\n                              {item.cropName}\r\n                            </div>\r\n                            <div className=\"order-item-meta\">\r\n                              {item.qty} × ₹{item.price}\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                      ))}\r\n\r\n                      {order.items.length > 3 && (\r\n                        <div className=\"more-items\">\r\n                          +{order.items.length - 3} more items\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n\r\n                    {/* FOOTER */}\r\n                    <div className=\"order-footer\">\r\n                      <div className=\"order-total\">\r\n                        ₹{order.total}\r\n                      </div>\r\n\r\n                      <div className=\"order-actions\">\r\n                        <button\r\n                          className=\"track-btn\"\r\n                          onClick={() =>\r\n                            navigate(`/orders/${order.orderId}`)\r\n                          }\r\n                        >\r\n                          Track Order\r\n                        </button>\r\n\r\n                        {order.status !== \"Cancelled\" && (\r\n                          <button\r\n                            className=\"cancel-btn\"\r\n                            onClick={() =>\r\n                              cancelOrder(order.orderId)\r\n                            }\r\n                          >\r\n                            Cancel\r\n                          </button>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            )}\r\n          </main>\r\n\r\n          <Footer />\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default MyOrders;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}